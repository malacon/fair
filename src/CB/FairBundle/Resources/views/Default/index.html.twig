{% extends 'FairBundle::layout.html.twig' %}

{% block content -%}

    {% if is_granted('ROLE_ADMIN') %}
        <div class="well">
            <p class="lead">The following links will allow you to see (and edit, be careful!) the parts of the fair.</p>

        </div>
    {% else %}
        <div class="well">
            {{ form_start(form, {'attr': {'class': 'form-inline'}}) }}
            {{ form_row(form.saveTop, {'attr': {'class': 'btn disabled btn-block'}}) }}
            <br>
            <div class="accordion" id="registration">
                <div class="accordion-group">
                    <div class="accordion-heading"><a data-toggle="collapse" data-parent="#registration" href="#bakedGoods">Baked Goods</a></div>
                </div>
                <div id="bakedGoods" class="accordion-body collapse in">
                    <div class="accordion-inner">
                        <ul class="bakedItems" data-prototype='{{ form_widget(form.bakedItems.vars.prototype.quantity, {'attr': {'placeholder': 'quantity', 'class': 'input-small'}})|e }} of {{ form_widget(form.bakedItems.vars.prototype.description, {'attr': {'rows': '1'}})|e }}'>
                            {% for bakedItem in form.bakedItems %}
                                <li>
                                    {{ form_widget(bakedItem.quantity, {'attr': {'placeholder': 'quantity', 'class': 'input-small'}}) }}
                                    of
                                    {{ form_widget(bakedItem.description, {'attr': {'rows': '1'}}) }}
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                <div class="accordion-group">
                    <div class="accordion-heading"><a data-toggle="collapse" data-parent="#registration" href="#auctionGoods">Auction Items</a></div>
                </div>
                <div id="auctionGoods" class="accordion-body collapse in">
                    <div class="accordion-inner">
                        <ul class="auctionItems" data-prototype='{{ form_widget(form.auctionItems.vars.prototype.quantity, {'attr': {'placeholder': 'quantity', 'class': 'input-small'}})|e }} of {{ form_widget(form.auctionItems.vars.prototype.description, {'attr': {'rows': '1'}})|e }} for {{ form_widget(form.auctionItems.vars.prototype.cost, {'attr': {'placeholder': 'cost', 'class': 'input-small'}})|e }}'>
                            {% for auctionItem in form.auctionItems %}
                                <li>
                                    {{ form_widget(auctionItem.quantity, {'attr': {'placeholder': 'quantity', 'class': 'input-small'}}) }}
                                    of
                                    {{ form_widget(auctionItem.description, {'attr': {'rows': '1'}}) }}
                                    for
                                    {{ form_widget(auctionItem.cost, {'attr': {'placeholder': 'cost', 'class': 'input-small'}}) }}
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                <div class="accordion-group">
                    <div class="accordion-heading"><a data-toggle="collapse" data-parent="#registration" href="#booths">Booths</a></div>
                </div>
                <div id="booths" class="accordion-body collapse in">
                    <div class="accordion-inner">
                        <dl>
                            {% for booth in booths %}
                                <dt>{{ booth }}</dt>
                                <dd>{{ booth.description }}</dd>
                                <dt>Location</dt>
                                <dd>{{ booth.location }}</dd>
                                <dt>Times</dt>
                                <dd class="times">
                                    <ul>
                                        {% for time in booth.times %}
                                            <li data-time-id="{{ time.id }}" data-timestamp="{{ time.time.getTimestamp() }}">
                                                {{ time }}
                                                {% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}  {# show not avaible if is filled and not using the current worker| true #}
                                                    <a href="{{ path('booth_work', {'id': time.id}) }}" class="btn btn-info btn-mini attend-toggle{% if time.hasWorker(app.user) %} hidden{% endif %}{% if time.isUserAlreadySignedUpAtThisTime(app.user) or time.isFilled() %} disabled{% endif %}">{% if time.isUserAlreadySignedUpAtThisTime(app.user) %}Already Working at this Time{% elseif time.isFilled() %}Currently Occupied{% else %}Signup{% endif %}</a>
                                                    <a href="{{ path('booth_unwork', {'id': time.id}) }}" class="btn btn-warning btn-mini not-attend-toggle{% if not time.hasWorker(app.user) %} hidden{% endif %}">Remove</a>
                                                {% endif %}
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </dd>
                            {% endfor %}
                        </dl>
                    </div>
                </div>
            </div>
            {{ form_row(form.saveBottom, {'attr': {'class': 'btn disabled btn-block'}}) }}
        </div>
    {% endif %}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('bundles/fair/js/register/register.js') }}"></script>
{% endblock %}
